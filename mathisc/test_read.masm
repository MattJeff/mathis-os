; Simple test de lecture de fichier

.module "test_read"
.version "1.0.0"

.constants:
    0: str "Test de lecture de fichier\n"
    1: str "/Users/mathishiguinen/Desktop/Higuinen/llml/examples/hello.mhs"
    2: str "Lecture...\n"
    3: str "Contenu:\n"
    4: str "---\n"
    5: str "\n---\nFin\n"

.func main
    .arity 0
    .locals 1
    .ai_block "test"
    .ai_intent "Test file reading"

    CONST 0
    SYSCALL 0x0011   ; println
    POP

    CONST 2
    SYSCALL 0x0011
    POP

    ; Read file
    CONST 1          ; path
    SYSCALL 0x0015   ; io_read_file
    SET_LOCAL 0

    CONST 3          ; "Contenu:"
    SYSCALL 0x0011
    POP

    CONST 4          ; separator
    SYSCALL 0x0011
    POP

    ; Print content
    GET_LOCAL 0
    SYSCALL 0x0011
    POP

    CONST 5
    SYSCALL 0x0011
    POP

    CONST_I64 0
    RET
.end
